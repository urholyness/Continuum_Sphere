<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Key Tester</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #0A1416; color: white; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #DF8012; border-radius: 5px; }
        .success { color: #4CAF50; }
        .error { color: #F44336; }
        .info { color: #2196F3; }
        input, button { padding: 8px; margin: 5px; }
        button { background: #DF8012; color: white; border: none; border-radius: 3px; cursor: pointer; }
        button:hover { background: #B8650A; }
        .result { margin: 10px 0; padding: 10px; background: #1a1a1a; border-radius: 3px; }
    </style>
</head>
<body>
    <h1>üß™ API Key Tester</h1>
    <p>Test your API keys individually before adding them to AWS Secrets Manager</p>

    <div class="test-section">
        <h3>AccuWeather API Test</h3>
        <input type="text" id="accuWeatherKey" placeholder="Enter AccuWeather API Key" style="width: 300px;">
        <button onclick="testAccuWeather()">Test AccuWeather</button>
        <div id="accuWeatherResult" class="result" style="display: none;"></div>
    </div>

    <div class="test-section">
        <h3>New Comprehensive Satellite API Test</h3>
        <input type="text" id="newApiKey" placeholder="New Satellite API Key" style="width: 300px;">
        <input type="text" id="newApiUrl" placeholder="API Base URL" style="width: 300px;" value="https://api.example.com">
        <button onclick="testNewSatelliteAPI()">Test New Comprehensive API</button>
        <div id="newApiResult" class="result" style="display: none;"></div>
    </div>

    <div class="test-section">
        <h3>Sentinel Hub API Test</h3>
        <input type="text" id="sentinelClientId" placeholder="Sentinel Hub Client ID" style="width: 200px;">
        <input type="text" id="sentinelClientSecret" placeholder="Sentinel Hub Client Secret" style="width: 200px;">
        <button onclick="testSentinelHub()">Test Sentinel Hub</button>
        <div id="sentinelResult" class="result" style="display: none;"></div>
    </div>

    <div class="test-section">
        <h3>Instructions</h3>
        <ol>
            <li>Get your API keys from the respective services</li>
            <li>Test each API key using the forms above</li>
            <li>Once all keys work, add them to AWS Secrets Manager</li>
            <li>Use the JSON structure provided in the console</li>
        </ol>
    </div>

    <script>
        async function testAccuWeather() {
            const apiKey = document.getElementById('accuWeatherKey').value;
            const resultDiv = document.getElementById('accuWeatherResult');
            
            if (!apiKey) {
                resultDiv.innerHTML = '<span class="error">Please enter an API key</span>';
                resultDiv.style.display = 'block';
                return;
            }

            resultDiv.innerHTML = '<span class="info">Testing AccuWeather API...</span>';
            resultDiv.style.display = 'block';

            try {
                // Test with Nairobi coordinates (close to your farms)
                const response = await fetch(`https://dataservice.accuweather.com/locations/v1/cities/geoposition/search?apikey=${apiKey}&q=-1.17,36.83`);
                
                if (response.ok) {
                    const data = await response.json();
                    resultDiv.innerHTML = `<span class="success">‚úÖ AccuWeather API working! Location: ${data[0]?.LocalizedName || 'Unknown'}</span>`;
                } else {
                    const errorText = await response.text();
                    resultDiv.innerHTML = `<span class="error">‚ùå AccuWeather API failed: ${response.status} - ${errorText}</span>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<span class="error">‚ùå AccuWeather API error: ${error.message}</span>`;
            }
        }

        async function testSentinelHub() {
            const clientId = document.getElementById('sentinelClientId').value;
            const clientSecret = document.getElementById('sentinelClientSecret').value;
            const resultDiv = document.getElementById('sentinelResult');
            
            if (!clientId || !clientSecret) {
                resultDiv.innerHTML = '<span class="error">Please enter both Client ID and Client Secret</span>';
                resultDiv.style.display = 'block';
                return;
            }

            resultDiv.innerHTML = '<span class="info">Testing Sentinel Hub API...</span>';
            resultDiv.style.display = 'block';

            try {
                // Test token request
                const response = await fetch('https://services.sentinel-hub.com/oauth/token', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: `grant_type=client_credentials&client_id=${clientId}&client_secret=${clientSecret}`
                });
                
                if (response.ok) {
                    const data = await response.json();
                    resultDiv.innerHTML = `<span class="success">‚úÖ Sentinel Hub API working! Token received: ${data.access_token ? 'Yes' : 'No'}</span>`;
                } else {
                    const errorText = await response.text();
                    resultDiv.innerHTML = `<span class="error">‚ùå Sentinel Hub API failed: ${response.status} - ${errorText}</span>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<span class="error">‚ùå Sentinel Hub API error: ${error.message}</span>`;
            }
        }
    </script>
</body>
</html>
